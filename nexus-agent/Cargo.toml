[package]
name = "nexus-agent"
version = "0.1.0"
edition = "2021"

[dependencies]
nexus-common = { path = "../nexus-common" }
nexus-infra = { path = "../nexus-infra" }
tokio = { workspace = true }
serde = { workspace = true }
serde_json = { workspace = true }
uuid = { workspace = true }
hostname = { workspace = true }
local-ip-address = { workspace = true }
base64 = { workspace = true }
log = { workspace = true }
env_logger = { workspace = true }
thiserror = { workspace = true }
hostname = { workspace = true }
local-ip-address = { workspace = true }
num_cpus = "1.16"

# Windows-specific dependencies
[target.'cfg(target_os = "windows")'.dependencies]
windows-sys = { workspace = true }

# Linux-specific dependencies
[target.'cfg(target_os = "linux")'.dependencies]
libc = "0.2"

[profile.release]
opt-level = 3
lto = true
codegen-units = 1
panic = "abort"
strip = true

# Windows subsystem configuration for stealth
[target.'cfg(target_os = "windows")'.profile.release]
opt-level = "z"
debug = false
